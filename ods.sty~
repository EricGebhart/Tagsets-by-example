
\makeatletter

\RequirePackage{geometry}
\RequirePackage{longtable}
\RequirePackage{times}
\RequirePackage{fancyvrb}
\RequirePackage{array}
\RequirePackage{hyperref}
\RequirePackage{graphicx}

\newif\ifsas@color
\sas@colorfalse

\DeclareOption{color}{\sas@colortrue}
\ProcessOptions

\def\sasContentTitle{%
   \small%
   \itshape%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
}
\def\sasOutput{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.94,0.94,0.94}%
}
\def\sasHeaderEmphasis{%
   \small%
   \itshape%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasNoteContent{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasGraph{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasWarnContentFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasNoteBanner{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasFatalContent{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasDataStrong{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.82,0.82,0.82}%
}
\def\sasDocument{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasBeforeCaption{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasContentsDate{%
   \small%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasPages{%
   \small%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasTitlesAndFooters{%
   \normalsize%
   \bfseries%
   \itshape%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasIndexProcName{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
}
\def\sasProcTitle{%
   \normalsize%
   \bfseries%
   \itshape%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasIndexAction{%
   \small%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
}
\def\sasData{%
   \small%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.82,0.82,0.82}%
}
\def\sasDataStrip{%
   \small%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.94,0.94,0.94}%
}
\def\sasTable{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.94,0.94,0.94}%
}
\def\sasFooterEmpty{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasSysTitleAndFooterContainer{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasRowFooterEmpty{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasContentFolder{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
}
\def\sasRowFooterEmphasis{%
   \small%
   \itshape%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasRowFooterStrongFixed{%
   \footnotesize%
   \bfseries%
   \ttfamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasRowFooterFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasIndex{%
   \small%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasFooterFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasExtendedPage{%
   \small%
   \itshape%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasContainer{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasDate{%
   \small%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasCaption{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasWarnBanner{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasFrame{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasHeaderStrongFixed{%
   \footnotesize%
   \bfseries%
   \ttfamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasIndexTitle{%
   \small%
   \itshape%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
}
\def\sasNoteContentFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasDataEmphasisFixed{%
   \footnotesize%
   \itshape%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.82,0.82,0.82}%
}
\def\sasNote{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasByline{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasFatalBanner{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasProcTitleFixed{%
   \footnotesize%
   \bfseries%
   \ttfamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasByContentFolder{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
}
\def\sasPagesProcLabel{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
}
\def\sasRowHeaderFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasRowFooterEmphasisFixed{%
   \footnotesize%
   \itshape%
   \ttfamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasWarnContent{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasDataEmpty{%
   \small%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.82,0.82,0.82}%
}
\def\sasCell{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasHeader{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasPageNo{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasContentProcLabel{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
}
\def\sasHeaderFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasPagesTitle{%
   \small%
   \itshape%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
}
\def\sasRowHeaderEmpty{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasPagesProcName{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
}
\def\sasBatch{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.82,0.82,0.82}%
}
\def\sasContentItem{%
   \small%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
}
\def\sasBody{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasPagesDate{%
   \small%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasHeaderEmpty{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasFooterStrong{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasFooterEmphasis{%
   \small%
   \itshape%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasErrorContent{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasDataFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.82,0.82,0.82}%
}
\def\sasHeaderStrong{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasDataEmphasis{%
   \small%
   \itshape%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.82,0.82,0.82}%
}
\def\sasTitleAndNoteContainer{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasRowFooter{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasIndexItem{%
   \small%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
}
\def\sasBylineContainer{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasFatalContentFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasBodyDate{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasContents{%
   \small%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasRowFooterStrong{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasUserText{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasHeadersAndFooters{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasRowHeaderEmphasisFixed{%
   \footnotesize%
   \itshape%
   \ttfamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasErrorBanner{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasContentProcName{%
   \small%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
}
\def\sasRowHeaderStrong{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasPagesItem{%
   \small%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
}
\def\sasRowHeader{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasFooterStrongFixed{%
   \footnotesize%
   \bfseries%
   \ttfamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasAfterCaption{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasRowHeaderStrongFixed{%
   \footnotesize%
   \bfseries%
   \ttfamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasRowHeaderEmphasis{%
   \small%
   \itshape%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasDataStrongFixed{%
   \footnotesize%
   \bfseries%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.82,0.82,0.82}%
}
\def\sasFooter{%
   \normalsize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasFolderAction{%
   \small%
   \sffamily%
   \color[rgb]{0,0.2,0.66}%
}
\def\sasHeaderEmphasisFixed{%
   \footnotesize%
   \itshape%
   \ttfamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
\def\sasSystemTitle{%
   \large%
   \bfseries%
   \itshape%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasErrorContentFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasSystemFooter{%
   \large%
   \bfseries%
   \itshape%
   \sffamily%
   \color[rgb]{0,0.13,0.53}%
   \columncolor[rgb]{0.87,0.87,0.87}%
}
\def\sasFooterEmphasisFixed{%
   \footnotesize%
   \itshape%
   \ttfamily%
   \color[rgb]{0,0.2,0.66}%
   \columncolor[rgb]{0.69,0.69,0.69}%
}
% Set cell padding
\renewcommand{\arraystretch}{1.3}

% Headings
\newcommand{\sasheading}[3][c]{{%
   \if#1r\flushright\else\if#1l\flushleft\else\center\fi\fi%
   {\csname sas#2\endcsname #3}%
   \if#1r\endflushright\else\if#1l\endflushleft\else\endcenter\fi\fi%
}}

\newcommand{\sasbyline}[2][c]{\sasheading[#1]{Byline}{#2}}
\newcommand{\sassystemtitle}[2][c]{\sasheading[#1]{SystemTitle}{#2}}
\newcommand{\sassystemfooter}[2][c]{\sasheading[#1]{SystemFooter}{#2}}
\newcommand{\sasproctitle}[2][c]{\sasheading[#1]{ProcTitle}{#2}}
\newcommand{\sascaption}[2][l]{\marginpar[#1]{\fbox{\parbox{0.7in}{\sasCaption{#2}}}}}

% Declare new verbatim type
\DefineVerbatimEnvironment{sasverbatim}{BVerbatim}%
                          {fontsize=\footnotesize,
                           commandchars=\\\{\},
                           formatcom=\sasBatch}

% Declare new column types
\newcolumntype{S}[2]{>{\csname sas#1\endcsname}#2}
\newcolumntype{d}{r}

% Set warning box style
\newlength\notewidth
\setlength\notewidth{4in}
\newcommand*{\saswarning}[2][c]{\sasmsg{Warning}{#1}{#2}}
\newcommand*{\saserror}[2][c]{\sasmsg{Error}{#1}{#2}}
\newcommand*{\sasnote}[2][c]{\sasmsg{Note}{#1}{#2}}
\newcommand*{\sasfatal}[2][c]{\sasmsg{Fatal}{#1}{#2}}
\newcommand*{\sasmsg}[3]{%
   \ifsas@color\let\columncolor\undefined\fi%
   \begin{center}%
   \begin{tabular}{ll}\hline%
   \multicolumn{1}{|S{#1Banner}{p{0.7in}}|}{#1} & %
   \multicolumn{1}{|S{#1Content}{p{\notewidth}}|}{#3\newline}\\\hline%
   \end{tabular}%
   \end{center}%
   \ifsas@color\let\columncolor\sascolumncolor\fi%
}

\ifsas@color\RequirePackage{colortbl}\fi

% Hack colortbl to allow \columncolor in macros
\let\CT@extract@org\CT@extract
\def\CT@extract{\futurelet\CT@NEXT\CT@extract@next}
\def\CT@extract@next{%
  \ifx\CT@NEXT\csname
    \@ReturnAfterFi{%
      \expandafter\expandafter\expandafter
    }%
  \fi
  \CT@extract@org
}
\long\def\@ReturnAfterFi#1\fi{\fi#1}

\ifsas@color

   \newcommand{\foreground}[1]{\color[rgb]{#1}}
   \newcommand{\sascolumncolor}[2][]{}
   \let\columncolor\sascolumncolor
   \newcommand{\documentforeground}[1]{\AtBeginDocument{\color[rgb]{#1}}}
   \newcommand{\documentbackground}[1]{\AtBeginDocument{\pagecolor[rgb]{#1}}}
   \def\sastable{\let\columncolor\undefined\tabular}
   \def\endsastable{\endtabular\let\columncolor\sascolumncolor}

\else

   \newcommand{\foreground}[1]{}
   \newcommand{\color}[2][]{}
   \newcommand{\sascolumncolor}[2][]{}
   \let\columncolor\sascolumncolor
   \newcommand{\documentforeground}[1]{}
   \newcommand{\documentbackground}[1]{}
   \def\sastable{\tabular}
   \def\endsastable{\endtabular}

\fi

\let\sasgraph\includegraphics

% Table of contents commands
\newcounter{sastarget}
\newcommand{\sascontents}[2][]{%
   \addtocounter{sastarget}{1}
   \def\currentTarget{\jobname.sas\thesastarget}
   \hypertarget{\currentTarget}{}
   \pdfbookmark[#1]{#2}{\currentTarget}
}
\makeatother

